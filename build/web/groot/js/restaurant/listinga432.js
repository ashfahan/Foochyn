function reposition(){var e=$("#restaurants").outerWidth(),t=$("#restaurants .restaurant").outerWidth(!0),i=Math.floor(e/t),s=[];$("#restaurants .restaurant").each(function(){for(var e=0,r=0;r<i;r++){if(void 0==s[r]){s[r]=0,e=r;break}s[e]>s[r]&&(e=r)}var l=$(this).children("div").outerHeight(!0)+20;$(this).css({position:"absolute",left:t*e,top:s[e]}),s[e]=s[e]+l}),changeContainerHeight(s,i)}function changeContainerHeight(e,t){for(var i=e[0],s=1;s<t;s++)i<e[s]&&(i=e[s]);$("#restaurants").height(i)}function filterApply(e){if($(".loader-filters").removeClass("hidden"),$("body").css("overflow","hidden"),isListing){setFilters();var t=$("#form-filters").serialize(),i=$("select[name=sort]").val();history.pushState(null,null,"?"+t),url="?"+t+"&sort="+i;var s=[],r=[];$("#form-filters input[type=checkbox]:checked").length;return $.ajax(url,{type:"GET",success:function(t){jsonResponse=jQuery.parseJSON(t),$("#container-restaurants").html(jsonResponse.restaurants),$(".filter-container").html(jsonResponse.filters),$(".loader-filters").addClass("hidden"),$("body").css("overflow","auto"),"filter"==e?(s=[],r=[],$("#form-filters input[type=checkbox]:checked").each(function(){$(this).data("value")&&s.push($(this).data("value")),$(this).data("name")&&r.push($(this).data("name"))}),Apxor.logEvent("Filter Applied",{"Filter Code":s,Medium:"Desktop Website",Status:"Success",Filters:r})):Apxor.logEvent("Restaurant Sort",{Source:"Restaurant Listing","Sort Type":$("#res_sort option:selected").text().trim(),Medium:"Desktop Website","Bucket Name":$("#nav_meal_period option:selected").text().trim()})},error:function(){$(".loader-filters").addClass("hidden"),$("body").css("overflow","auto"),s=[],r=[],$("#form-filters input[type=checkbox]:checked").each(function(e,t){$(this).data("value")&&s.push($(this).data("value")),$(this).data("name")&&r.push($(this).data("name"))}),Apxor.logEvent("Filter Applied",{"Filter Code":s,Medium:"Desktop Website",Status:"Success",Filters:r})},cache:!1}),!1}setFilters();var t=$("#form-filters").serialize();window.location.href="/restaurants?"+t}function setFilters(){$(".selected-filter").show(),$("#selected-filters").html(""),0==$("#form-filters input:checkbox:checked").length&&$("#selected-filters").removeClass("filter-border"),$("#form-filters input[type=checkbox]").each(function(){if(this.checked){var e=$(this).data("name"),t=$(this).val(),i=$(this).attr("name"),s=$("#templates>.selected-filter").clone();s.find(".name").text(e),s.attr("data-id",t),s.attr("data-type",i),$("#selected-filters").addClass("filter-border"),$("#selected-filters").append(s)}}),$("#form-filters input:checkbox:checked").length>=2&&$("#selected-filters").append('<button id="resetFilter" class="btn btn-dark-grey btn-md margin-r-10 white">Clear all </button>')}$("body").delegate(".filter-button","click",function(){$("#filter-box").fadeIn()}),$("body").delegate(".filter-close-button","click",function(){$("#filter-box").fadeOut()}),$("body").delegate("#filter-groups>li","click",function(){$("#filters>.filter").removeClass("active");var e=$(this).data("filter");$(e).addClass("active"),$("#filter-groups>li").removeClass("active"),$(this).addClass("active")}),$("body").delegate("select[name=sort]","change",function(){filterApply("sort")}),setFilters(),$("body").delegate("#selected-filters .remove","click",function(){var e=$(this).closest(".selected-filter"),t=e.data("type"),i=e.data("id");$('#form-filters input[name="'+t+'"]').each(function(){$(this).val()==i&&$(this).prop("checked",!1)}),e.remove(),filterApply("filter")}),$("body").delegate("#resetFilter","click",function(){$(".selected-filter").hide(),$('#form-filters input[type="checkbox"]').each(function(){$(this).prop("checked",!1)}),filterApply("filter")}),$("body").delegate("#filter_edit","click",function(){$(this).parent(".editbox").hide().next(".edit-form").show()}),$("body").delegate("#cancel_btn","click",function(){$(".edit-form").hide(),$(".editbox").show()}),$("body").delegate(".panel","click",function(){"−"==$(this).find("span").html()?$(this).find("span").html("+"):$(this).find("span").html("−"),$(this).next(".accordion-o").toggleClass("hidden-notImp")}),$("body").delegate('#form-filters input[type="checkbox"]',"click",function(){filterApply("filter")}),$("body").delegate(".more_deal","click",function(){$(this).next().slideDown(1e3),$(this).hide(),$(".less_deal").show(2e3)}),$("body").delegate(".less_deal","click",function(){$(this).parent("div").slideUp(1e3),$(this).hide(),$(".more_deal").show(2e3)});